<!DOCTYPE html>
<html lang="zh-cn">

<head>
    <title>Pomodoro Timer</title>
    <meta charset="UTF-8">
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <link rel="stylesheet" href="../html/bootstrap-4.3.1-dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="../html/font-awesome-4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../html/fontawesome-free-5.9.0-web/css/all.css">
    <link rel="stylesheet" href="css/main.css">
</head>

<body>
    <div class="nav">
        <ul id="main_menu">
            <li id="counter_index">
                <i class="far fa-clock"></i>
            </li>
            <li id="schedule_list">
                <i class="fas fa-align-left"></i>
            </li>
            <li id="analyze_list">
                <i class="fas fa-chart-line"></i>
            </li>
        </ul>
        <ul class="user">
            <li class="">
                <a href="#"><i class="fa fa-user-circle"></i></a>
            </li>
            <li>
                <a href="#"><i class="fa fa-power-off"></i></a>
            </li>
        </ul>
    </div>
    <div class="main">
        <div class="container-fluid">
            <div class="row" id="counter_main" style="display: none;">
                <div class="col-xl-3 col-md-4">
                    <div class="menu">
                        <div class="schedule_list">
                            <div class="list_title">schedule</div>
                            <div class="list_content">
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row last">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                            </div>
                            <div class="add_mission">
                                <i class="fas fa-plus"></i>
                            </div>
                        </div>
                        <div class="w-100"></div>
                        <div class="schedule_list complete">
                            <div class="list_title">complete mission</div>
                            <div class="list_content">
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                                <div class="schedule_row last">
                                    <span class="mission_icon"></span>
                                    <span class="schedule_text">title title title</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="counter">
                        <div class="header">
                            <div class="row">
                                <div class="col-auto">
                                    <div class="date">15</div>
                                    <div class="calendar">
                                        <div class="week">Monday</div>
                                        <div class="month">Jul 2019</div>
                                    </div>
                                </div>
                                <div class="col-auto ml-auto mt-auto">
                                    <div class="logo">Pomodoro Timer</div>
                                </div>
                            </div>
                        </div>
                        <div class="clock">
                            <div id="clock_div">
                                <div class="clock_pointer"></div>
                            </div>
                            <div id="clock_timer">25:00</div>
                        </div>
                        <div class="clock_play">
                            <ul>
                                <li class="pause">
                                    <a href="#" id="pause">
                                        <i class="fas fa-pause"></i>
                                    </a>
                                </li>
                                <li class="play">
                                    <a href="#" id="play">
                                        <i class="fas fa-play"></i>
                                    </a>
                                </li>
                                <li class="stop">
                                    <a href="#" id="stop">
                                        <i class="fas fa-stop"></i>
                                    </a>
                                </li>
                            </ul>
                        </div>
                        <div class="mission">
                            <div class="mission_title">title title title title title</div>
                            <!-- <div class="mission_time">start from -->
                            <!-- <div class="mission_time">10:11</div> -->
                        </div>
                    </div>
                </div>
            </div>
            <div id="content" style="display: none;"></div>
        </div>
    </div>
    <!-- <script src="../html/bootstrap-4.3.1-dist/js/bootstrap.min.js" type="text/javascript"></script> -->
    <script src="../html/js/jquery-1.8.3.min.js" type="text/javascript"></script>
    <!-- <script src="../html/js/jquery-3.4.1.min.js" type="text/javascript"></script> -->
    <!-- <script src="../html/js/jquery-migrate-1.1.1.js" type="text/javascript"></script> -->
    <script src="../html/js/jquery.history.js" type="text/javascript"></script>
    <!-- <script src="../html/fontawesome-free-5.9.0-web/js/all.min.js" type="text/javascript"></script> -->
    <script src="js/init_url.js" type="text/javascript"></script>
    <script>
    $('#main_menu').find('#' + template_url).addClass('active');

    function div_showHide(showContent, hideContent) {
        $(showContent).show();
        $(hideContent).hide();
    }

    function scheduleHeight() {
        $('#counter_main .schedule_list').each(function() {
            var _listHeight = $(this).height();
            $(this).find('.list_content').css('max-height', _listHeight - 50)
        })
    }

    function clockSize() {
        var clock = $('#counter_main .clock'),
            _divHeight = $(window).height(),
            _clockMaxHeight = _divHeight - 350;
        if ($('.counter').width() > _divHeight) {
            clock.css({
                'height': _clockMaxHeight,
                'width': _clockMaxHeight
            });
        } else {
            clock.css({
                'max-height': _clockMaxHeight,
                'height': clock.width() + 20
            });
            if (_clockMaxHeight > 600) {
                clock.css({
                    'max-width': 600
                });
            } else {
                clock.css({
                    'max-width': _clockMaxHeight
                });
            }
        }
    }

    if (template_url == 'counter_index') {
        div_showHide('#counter_main', '#content')
    } else {
        div_showHide('#content', '#counter_main')
    }

    scheduleHeight();
    clockSize();

    var _rwdAlert = true;
    $(window).resize(function() {
        scheduleHeight();
        clockSize();
        if (($(window).width() % 50 == 0)) {
            if (_rwdAlert) {
                alert('我的RWD有時候會自己爆掉，請輕一點');
                _rwdAlert = false;
            }
        }
    })

    $('#main_menu li').on('click', function() {
        $(this).siblings().removeClass('active');
        $(this).addClass('active');
        var tempForm = $(this).attr('id');
        changeForm(tempForm);
        if (tempForm == 'counter_index') {
            div_showHide('#counter_main', '#content')
            scheduleHeight();
            clockSize();
        } else {
            div_showHide('#content', '#counter_main')
        }
    })

    $('.clock_play li').on('click', function() {
        $(this).siblings().removeClass('active');
        $(this).addClass('active');
        $('.clock_play .stop').removeClass('active');
    })

    // counter
    var CountDown = (function($) {
        // Length ms 
        var TimeOut = 10000;
        // Interval ms
        var TimeGap = 1000;

        var CurrentTime = (new Date()).getTime();
        var EndTime = (new Date()).getTime() + TimeOut;

        var counterTimer = $('#clock_timer');
        var counterPause = $('#pause');
        var counterPlay = $('#play');

        var Running = false;

        var UpdateTimer = function() {
            // Run till timeout
            if (CurrentTime + TimeGap < EndTime) {
                setTimeout(UpdateTimer, TimeGap);
            }
            // Countdown if running
            if (Running) {
                CurrentTime += TimeGap;
                if (CurrentTime >= EndTime) {
                    counterTimer.css('color', 'red');
                }
            }
            // Update counter
            var Time = new Date();
            Time.setTime(EndTime - CurrentTime);
            var Minutes = Time.getMinutes();
            var Seconds = Time.getSeconds();
            var _pointerDeg = (60 - Seconds) * 6;

            counterTimer.html(
                (Minutes < 10 ? '0' : '') + Minutes +
                ':' +
                (Seconds < 10 ? '0' : '') + Seconds);
            $('#clock_div').css('transform', 'rotate(' + _pointerDeg + 'deg)')
        };

        var Pause = function() {
            Running = false;
        };

        var Play = function() {
            Running = true;
        };

        var Stop = function() {
            Running = false;
        };

        var Start = function(Timeout) {
            TimeOut = Timeout;
            CurrentTime = (new Date()).getTime();
            EndTime = (new Date()).getTime() + TimeOut;
            UpdateTimer();
        };

        return {
            Pause: Pause,
            Play: Play,
            Stop: Stop,
            Start: Start
        };
    })(jQuery);

    jQuery('#pause').on('click', CountDown.Pause);
    jQuery('#play').on('click', CountDown.Play);
    jQuery('#stop').on('click', CountDown.Stop);

    // ms
    CountDown.Start(1500000);
    </script>
</body>

</html>